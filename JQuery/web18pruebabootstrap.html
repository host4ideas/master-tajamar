<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="description" content="" />
        <meta
            name="author"
            content="Mark Otto, Jacob Thornton, and Bootstrap contributors"
        />
        <meta name="generator" content="Hugo 0.104.2" />
        <title>Album example · Bootstrap v5.2</title>

        <link
            rel="canonical"
            href="https://getbootstrap.com/docs/5.2/examples/album/"
        />

        <link
            href="../bootstrap-5.2.2-dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi"
            crossorigin="anonymous"
        />

        <!-- Favicons -->
        <link
            rel="apple-touch-icon"
            href="/docs/5.2/assets/img/favicons/apple-touch-icon.png"
            sizes="180x180"
        />
        <link
            rel="icon"
            href="/docs/5.2/assets/img/favicons/favicon-32x32.png"
            sizes="32x32"
            type="image/png"
        />
        <link
            rel="icon"
            href="/docs/5.2/assets/img/favicons/favicon-16x16.png"
            sizes="16x16"
            type="image/png"
        />
        <link
            rel="manifest"
            href="/docs/5.2/assets/img/favicons/manifest.json"
        />
        <link
            rel="mask-icon"
            href="/docs/5.2/assets/img/favicons/safari-pinned-tab.svg"
            color="#712cf9"
        />
        <link rel="icon" href="/docs/5.2/assets/img/favicons/favicon.ico" />
        <meta name="theme-color" content="#712cf9" />
        <script src="./jquery-3.6.1.min.js"></script>

        <style>
            .bd-placeholder-img {
                font-size: 1.125rem;
                text-anchor: middle;
                -webkit-user-select: none;
                -moz-user-select: none;
                user-select: none;
            }

            @media (min-width: 768px) {
                .bd-placeholder-img-lg {
                    font-size: 3.5rem;
                }
            }

            .b-example-divider {
                height: 3rem;
                background-color: rgba(0, 0, 0, 0.1);
                border: solid rgba(0, 0, 0, 0.15);
                border-width: 1px 0;
                box-shadow: inset 0 0.5em 1.5em rgba(0, 0, 0, 0.1),
                    inset 0 0.125em 0.5em rgba(0, 0, 0, 0.15);
            }

            .b-example-vr {
                flex-shrink: 0;
                width: 1.5rem;
                height: 100vh;
            }

            .bi {
                vertical-align: -0.125em;
                fill: currentColor;
            }

            .nav-scroller {
                position: relative;
                z-index: 2;
                height: 2.75rem;
                overflow-y: hidden;
            }

            .nav-scroller .nav {
                display: flex;
                flex-wrap: nowrap;
                padding-bottom: 1rem;
                margin-top: -1px;
                overflow-x: auto;
                text-align: center;
                white-space: nowrap;
                -webkit-overflow-scrolling: touch;
            }
        </style>
    </head>
    <body>
        <header>
            <div class="collapse bg-dark" id="navbarHeader">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-8 col-md-7 py-4">
                            <h4 class="text-white">About</h4>
                            <p class="text-muted">
                                Add some information about the album below, the
                                author, or any other background context. Make it
                                a few sentences long so folks can pick up some
                                informative tidbits. Then, link them off to some
                                social networking sites or contact information.
                            </p>
                        </div>
                        <div class="col-sm-4 offset-md-1 py-4">
                            <h4 class="text-white">Contact</h4>
                            <ul class="list-unstyled">
                                <li>
                                    <a href="#" class="text-white"
                                        >Follow on Twitter</a
                                    >
                                </li>
                                <li>
                                    <a href="#" class="text-white"
                                        >Like on Facebook</a
                                    >
                                </li>
                                <li>
                                    <a href="#" class="text-white">Email me</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="navbar navbar-dark bg-dark shadow-sm">
                <div class="container">
                    <a href="#" class="navbar-brand d-flex align-items-center">
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="20"
                            height="20"
                            fill="none"
                            stroke="currentColor"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            aria-hidden="true"
                            class="me-2"
                            viewBox="0 0 24 24"
                        >
                            <path
                                d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"
                            />
                            <circle cx="12" cy="13" r="4" />
                        </svg>
                        <strong>Album</strong>
                    </a>
                    <button
                        class="navbar-toggler"
                        type="button"
                        data-bs-toggle="collapse"
                        data-bs-target="#navbarHeader"
                        aria-controls="navbarHeader"
                        aria-expanded="false"
                        aria-label="Toggle navigation"
                    >
                        <span class="navbar-toggler-icon"></span>
                    </button>
                </div>
            </div>
        </header>

        <main>
            <div class="album py-5 bg-light">
                <div class="container">
                    <h1>Ejemplo CRUD jQuery</h1>

                    <br />
                    <hr />
                    <br />

                    <label for="cajaNumero">Numero: </label>
                    <input type="text" name="cajaNumero" id="cajaNumero" />

                    <label for="cajaNombre">Nombre: </label>
                    <input type="text" name="cajaNombre" id="cajaNombre" />

                    <label for="cajaLocalidad">Localidad: </label>
                    <input
                        type="text"
                        name="cajaLocalidad"
                        id="cajaLocalidad"
                    />

                    <br />
                    <br />

                    <div class="btn-group">
                        <button
                            class="btn btn-outline-primary"
                            id="botonInsertar"
                        >
                            Insertar
                        </button>
                        <button
                            class="btn btn-outline-primary"
                            id="botonEliminar"
                        >
                            Eliminar
                        </button>
                        <button
                            class="btn btn-outline-primary"
                            id="botonEliminarTodo"
                        >
                            Eliminar Todo
                        </button>
                        <button
                            class="btn btn-outline-primary"
                            id="botonModificar"
                        >
                            Modificar
                        </button>
                        <button
                            class="btn btn-outline-primary"
                            id="botonCargar"
                        >
                            Cargar
                        </button>
                    </div>

                    <br />
                    <hr />
                    <br />

                    <table class="table">
                        <thead>
                            <tr>
                                <th>Número</th>
                                <th>Nombre</th>
                                <th>Localidad</th>
                            </tr>
                        </thead>
                        <tbody id="resultado"></tbody>
                    </table>
                </div>
            </div>
        </main>

        <script>
            let url = "https://apicruddepartamentoscore.azurewebsites.net";

            function cargarDepartamentos() {
                let request = url + "/api/departamentos";

                $.ajax({
                    url: request,
                    method: "GET",
                    dataType: "json",
                    success: function (data) {
                        console.log("Leyendo servicio");
                        let html = "";
                        $.each(data, function (indice, departamento) {
                            html += `
								<tr>
									<th>${departamento.numero}</th>
									<th>${departamento.nombre}</th>
									<th>${departamento.localidad}</th>
								</tr>
							`;
                        });
                        $("#resultado").html(html);
                    },
                    error: function (error) {
                        console.log(error.message);
                    },
                });
            }

            $(document).ready(function () {
                setInterval(() => {
                    cargarDepartamentos();
                }, 500);

                $("#botonInsertar").click(function () {
                    let request = url + "/api/departamentos";
                    let objetoInsertar;

                    const numeroModificar = parseInt($("#cajaNumero").val());
                    const nuevoNombre = $("#cajaNombre").val();
                    const nuevaLocalidad = $("#cajaLocalidad").val();

                    if (nuevoNombre && nuevaLocalidad && numeroModificar) {
                        objetoInsertar = {
                            numero: numeroModificar,
                            nombre: nuevoNombre,
                            localidad: nuevaLocalidad,
                        };

                        $.ajax({
                            url: request,
                            type: "POST",
                            contentType: "application/json",
                            data: JSON.stringify(objetoInsertar),
                            success: function () {
                                cargarDepartamentos();
                            },
                            error: function (error) {
                                console.log(error);
                            },
                        });
                    }
                });

                $("#botonEliminarTodo").click(function () {
                    let request = url + "/api/departamentos/";

                    $.ajax({
                        url: request,
                        method: "GET",
                        dataType: "json",
                        headers: {
                            "Access-Control-Allow-Origin": true,
                        },
                        success: function (data) {
                            const departamentos = data;

                            $.each(
                                departamentos,
                                function (indice, departamento) {
                                    $.ajax({
                                        url: request + departamento.numero,
                                        method: "DELETE",
                                        success: function () {
                                            cargarDepartamentos();
                                        },
                                        error: function (error) {
                                            console.log(error.message);
                                        },
                                    });
                                }
                            );
                        },
                        error: function (error) {
                            console.log(error.message);
                        },
                    });
                });

                $("#botonEliminar").click(function () {
                    let request = url + "/api/departamentos/";
                    let objetoInsertar;

                    const numeroModificar = $("#cajaNumero").val();

                    if (numeroModificar) {
                        $.ajax({
                            url: request + numeroModificar,
                            method: "DELETE",
                            success: function () {
                                cargarDepartamentos();
                            },
                            error: function (error) {
                                console.log(error.message);
                            },
                        });
                    }
                });

                $("#botonModificar").click(function () {
                    let request = url + "/api/departamentos/";

                    const numeroModificar = parseInt($("#cajaNumero").val());
                    const nuevoNombre = $("#cajaNombre").val();
                    const nuevaLocalidad = $("#cajaLocalidad").val();

                    if (nuevoNombre && nuevaLocalidad && numeroModificar) {
                        objetoInsertar = {
                            numero: numeroModificar,
                            nombre: nuevoNombre,
                            localidad: nuevaLocalidad,
                        };

                        $.ajax({
                            url: request,
                            type: "PUT",
                            contentType: "application/json",
                            data: JSON.stringify(objetoInsertar),
                            success: function () {
                                cargarDepartamentos();
                            },
                            error: function (error) {
                                console.log(error);
                            },
                        });
                    }
                });
            });
        </script>
        <script
            src="../bootstrap-5.2.2-dist/js/bootstrap.bundle.min.js"
            integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
            crossorigin="anonymous"
        ></script>
    </body>
</html>
